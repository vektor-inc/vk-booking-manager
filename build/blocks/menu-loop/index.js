(()=>{"use strict";var e,o={386(e,o,r){const a=window.wp.blocks,t=window.wp.i18n,n=JSON.parse('{"apiVersion":3,"name":"vk-booking-manager/menu-loop","title":"menu loop","description":"Narrow down and display service menu posts based on conditions.","category":"widgets","icon":"index-card","textdomain":"vk-booking-manager","keywords":["menu","query","booking"],"attributes":{"loopId":{"type":"string","default":""},"itemsPerPage":{"type":"number","default":-1},"order":{"type":"string","default":"ASC"},"orderBy":{"type":"string","default":"menu_order"},"displayMode":{"type":"string","default":"card"},"groupFilterMode":{"type":"string","default":"all"},"selectedGroupIds":{"type":"array","default":[],"items":{"type":"number"}},"hideGroupTitle":{"type":"boolean","default":false},"showImage":{"type":"boolean","default":true},"showExcerpt":{"type":"boolean","default":true},"showMeta":{"type":"boolean","default":true},"showCategories":{"type":"boolean","default":true},"showDetailButton":{"type":"boolean","default":true},"showReserveButton":{"type":"boolean","default":true},"buttonLabel":{"type":"string","default":"View details"},"reserveButtonLabel":{"type":"string","default":"Proceed to Reservation"},"reserveButtonUrl":{"type":"string","default":""},"emptyMessage":{"type":"string","default":""}},"supports":{"align":["wide","full"],"anchor":true,"customClassName":true,"spacing":{"margin":true,"padding":true}},"style":"file:./style-index.css","editorStyle":"file:./index.css","editorScript":"file:./index.js"}'),l=window.wp.blockEditor,i=window.wp.components,s=window.wp.serverSideRender;var d=r.n(s);const g=window.wp.element,u=window.wp.data,p=(e="")=>e.toString().trim().toLowerCase().replace(/[^a-z0-9_-]/g,""),c=(e=[])=>e.reduce((e,o)=>o?(e.push(o),Array.isArray(o.innerBlocks)&&o.innerBlocks.length&&e.push(...c(o.innerBlocks)),e):e,[]),b=window.ReactJSXRuntime,k=[{label:(0,t.__)("Menu order","vk-booking-manager"),value:"menu_order"},{label:(0,t.__)("title","vk-booking-manager"),value:"title"},{label:(0,t.__)("Release date","vk-booking-manager"),value:"date"},{label:(0,t.__)("Update date","vk-booking-manager"),value:"modified"},{label:(0,t.__)("random","vk-booking-manager"),value:"rand"}],m=[{label:(0,t.__)("ascending order","vk-booking-manager"),value:"ASC"},{label:(0,t.__)("descending order","vk-booking-manager"),value:"DESC"}],v=[{label:(0,t.__)("card","vk-booking-manager"),value:"card"},{label:(0,t.__)("text","vk-booking-manager"),value:"text"}],h=[{label:(0,t.__)("All service groups","vk-booking-manager"),value:"all"},{label:(0,t.__)("Specified service group","vk-booking-manager"),value:"selected"}],_=e=>{let o=1;for(;e.has(`loop-${o}`);)o+=1;return`loop-${o}`};(0,t.__)("Menu Loop Block","vk-booking-manager"),(0,a.registerBlockType)(n,{edit:({attributes:e,setAttributes:o,clientId:r})=>{const a=(0,l.useBlockProps)(),{loopBlocks:s,serviceGroups:y}=(0,u.useSelect)(e=>{const o=e("core").getEntityRecords("taxonomy","vkbm_service_menu_group",{per_page:-1,orderby:"name",order:"asc"});return{loopBlocks:c(e("core/block-editor").getBlocks()).filter(e=>e?.name===n.name),serviceGroups:Array.isArray(o)?o:[]}},[]),w=(0,g.useMemo)(()=>{const e=new Set;return s.filter(e=>e.clientId!==r).forEach(o=>{o?.attributes?.loopId&&e.add(o.attributes.loopId)}),e},[s,r]);(0,g.useEffect)(()=>{e.loopId||o({loopId:_(w)})},[e.loopId,w,o]);const f=e.loopId&&s.some(o=>o.clientId!==r&&o?.attributes?.loopId===e.loopId),x=Array.isArray(e.selectedGroupIds)?e.selectedGroupIds:[];return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(l.InspectorControls,{children:[(0,b.jsxs)(i.PanelBody,{title:(0,t.__)("Menu display settings","vk-booking-manager"),children:[(0,b.jsx)(i.TextControl,{label:(0,t.__)("Menu loop ID","vk-booking-manager"),help:(0,t.__)("This is an identifier for linking with the search block.","vk-booking-manager"),value:e.loopId||"",onChange:e=>o({loopId:p(e)})}),f&&(0,b.jsx)(i.Notice,{status:"error",isDismissible:!1,children:(0,t.__)("A menu loop with the same ID exists. Please change to another ID.","vk-booking-manager")}),(0,b.jsx)(i.SelectControl,{label:(0,t.__)("display mode","vk-booking-manager"),value:e.displayMode||"card",options:v,onChange:e=>o({displayMode:e})}),(0,b.jsx)(i.ToggleControl,{label:(0,t.__)("Do not display the proceed to reservation button","vk-booking-manager"),checked:!e.showReserveButton,onChange:e=>o({showReserveButton:!e})}),(0,b.jsx)(i.SelectControl,{label:(0,t.__)("Sort","vk-booking-manager"),value:e.orderBy,options:k,onChange:e=>o({orderBy:e})}),(0,b.jsx)(i.SelectControl,{label:(0,t.__)("sort order","vk-booking-manager"),value:e.order,options:m,onChange:e=>o({order:e})}),(0,b.jsx)(i.SelectControl,{label:(0,t.__)("service group","vk-booking-manager"),value:e.groupFilterMode||"all",options:h,onChange:e=>o({groupFilterMode:e})}),"selected"===(e.groupFilterMode||"all")&&(0,b.jsx)("div",{className:"vkbm-menu-loop__group-filter",children:0===y.length?(0,b.jsx)(i.Notice,{status:"warning",isDismissible:!1,children:(0,t.__)("Service group has not been registered yet.","vk-booking-manager")}):y.map(e=>(0,b.jsx)(i.CheckboxControl,{label:e.name,checked:x.includes(e.id),onChange:r=>((e,r)=>{const a=Number(e);if(!a)return;const t=r?Array.from(new Set([...x,a])):x.filter(e=>e!==a);o({selectedGroupIds:t})})(e.id,r)},e.id))}),(0,b.jsx)(i.ToggleControl,{label:(0,t.__)("Do not display service group name","vk-booking-manager"),checked:Boolean(e.hideGroupTitle),onChange:e=>o({hideGroupTitle:e})})]}),(0,b.jsxs)(i.PanelBody,{title:(0,t.__)("Display element","vk-booking-manager"),initialOpen:!1,children:[(0,b.jsx)(i.ToggleControl,{label:(0,t.__)("Display featured image","vk-booking-manager"),checked:e.showImage,onChange:e=>o({showImage:e})}),(0,b.jsx)(i.ToggleControl,{label:(0,t.__)("View Service Tag","vk-booking-manager"),checked:e.showCategories,onChange:e=>o({showCategories:e})}),(0,b.jsx)(i.ToggleControl,{label:(0,t.__)("Show excerpt","vk-booking-manager"),checked:e.showExcerpt,onChange:e=>o({showExcerpt:e})}),(0,b.jsx)(i.ToggleControl,{label:(0,t.__)("Show required time/price","vk-booking-manager"),checked:e.showMeta,onChange:e=>o({showMeta:e})}),(0,b.jsx)(i.ToggleControl,{label:(0,t.__)("Show details button","vk-booking-manager"),checked:e.showDetailButton,onChange:e=>o({showDetailButton:e})}),(0,b.jsx)(i.TextControl,{label:(0,t.__)("Zero messages","vk-booking-manager"),help:(0,t.__)("If the field is left blank, automatic text will be displayed.","vk-booking-manager"),value:e.emptyMessage,onChange:e=>o({emptyMessage:e})})]})]}),(0,b.jsx)("div",{...a,children:(0,b.jsx)(d(),{block:n.name,attributes:e})})]})},save:()=>null})}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return o[e](n,n.exports,a),n.exports}a.m=o,e=[],a.O=(o,r,t,n)=>{if(!r){var l=1/0;for(g=0;g<e.length;g++){for(var[r,t,n]=e[g],i=!0,s=0;s<r.length;s++)(!1&n||l>=n)&&Object.keys(a.O).every(e=>a.O[e](r[s]))?r.splice(s--,1):(i=!1,n<l&&(l=n));if(i){e.splice(g--,1);var d=t();void 0!==d&&(o=d)}}return o}n=n||0;for(var g=e.length;g>0&&e[g-1][2]>n;g--)e[g]=e[g-1];e[g]=[r,t,n]},a.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return a.d(o,{a:o}),o},a.d=(e,o)=>{for(var r in o)a.o(o,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},a.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),(()=>{var e={17:0,765:0};a.O.j=o=>0===e[o];var o=(o,r)=>{var t,n,[l,i,s]=r,d=0;if(l.some(o=>0!==e[o])){for(t in i)a.o(i,t)&&(a.m[t]=i[t]);if(s)var g=s(a)}for(o&&o(r);d<l.length;d++)n=l[d],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(g)},r=globalThis.webpackChunkvk_booking_manager=globalThis.webpackChunkvk_booking_manager||[];r.forEach(o.bind(null,0)),r.push=o.bind(null,r.push.bind(r))})();var t=a.O(void 0,[765],()=>a(386));t=a.O(t)})();